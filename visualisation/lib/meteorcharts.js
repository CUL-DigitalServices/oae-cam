var MeteorCharts;!function(){MeteorCharts={version:"0.0.6"}}(),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.returnExports=b()}(this,function(){return MeteorCharts});var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a};return function(e,f,g){var h=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(f=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");f=String(h.masks[f]||f||h.masks["default"]),"UTC:"==f.slice(0,4)&&(f=f.slice(4),g=!0);var i=g?"getUTC":"get",j=e[i+"Date"](),k=e[i+"Day"](),l=e[i+"Month"](),m=e[i+"FullYear"](),n=e[i+"Hours"](),o=e[i+"Minutes"](),p=e[i+"Seconds"](),q=e[i+"Milliseconds"](),r=g?0:e.getTimezoneOffset(),s={d:j,dd:d(j),ddd:h.i18n.dayNames[k],dddd:h.i18n.dayNames[k+7],m:l+1,mm:d(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(m).slice(2),yyyy:m,h:n%12||12,hh:d(n%12||12),H:n,HH:d(n),M:o,MM:d(o),s:p,ss:d(p),l:d(q,3),L:d(q>99?Math.round(q/10):q),t:12>n?"a":"p",tt:12>n?"am":"pm",T:12>n?"A":"P",TT:12>n?"AM":"PM",Z:g?"UTC":(String(e).match(b)||[""]).pop().replace(c,""),o:(r>0?"-":"+")+d(100*Math.floor(Math.abs(r)/60)+Math.abs(r)%60,4),S:["th","st","nd","rd"][j%10>3?0:(10!=j%100-j%10)*j%10]};return f.replace(a,function(a){return a in s?s[a]:a.slice(1,a.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(a,b){return dateFormat(this,a,b)},function(){var a="mousemove",b="mouseout",c="mouseover",d="touchstart",e="touchend",f="mousedown",a="mousemove",g="mouseup",h="hovering",i="zooming",j="panning";MeteorCharts.Chart=function(a){this._init(a)},MeteorCharts.Chart.prototype={_init:function(a){var b=this;this.model=a.model||{},this.view=a.view||{},this._view=new MeteorCharts.View(this),this.events={},this._setState(h),this.stage=new Kinetic.Stage({container:a.container,listening:!1,width:this._view.get("width"),height:this._view.get("height")}),this.stage.getContainer().style.display="inline-block",this.bottomLayer=new Kinetic.Layer({listening:!1}),this.dataLayer=new Kinetic.Layer({listening:!1}),this.interactionLayer=new Kinetic.Layer({opacity:0,listening:!1}),this.topLayer=new Kinetic.Layer({listening:!1}),this.bottomLayer.getCanvas()._canvas.className="meteorcharts-bottom-layer",this.dataLayer.getCanvas()._canvas.className="meteorcharts-data-layer",this.topLayer.getCanvas()._canvas.className="meteorcharts-top-layer",this.interactionLayer.getCanvas()._canvas.className="meteorcharts-interaction-layer",this.stage.add(this.bottomLayer),this.stage.add(this.dataLayer),this.stage.add(this.topLayer),this.stage.add(this.interactionLayer),this.title=new MeteorCharts.Title(this),this.interactionShow=new Kinetic.Tween({node:b.interactionLayer,duration:.3,opacity:1,easing:Kinetic.Easings.EaseInOut}),this._bind()},batchDraw:function(){this.enableSeriesTween=!1,this.stage.batchDraw()},draw:function(){this.enableSeriesTween=!0,this.stage.draw(),this.fire("draw")},showInteractionLayer:function(){this.interactionShow.play()},hideInteractionLayer:function(){this.interactionShow.reverse()},on:function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},fire:function(a){var b,c,d=this.events[a];if(d)for(b=d.length,c=0;b>c;c++)d[c]()},_setState:function(a){this.state=a,this.fire("stateChange")},_bind:function(){var k=this.stage,l=this,m=!1;document.body.addEventListener("keydown",function(){m=!0}),document.body.addEventListener("keyup",function(){m=!1}),k.on(f,function(){switch(l.state){case h:m?l._setState(j):l._setState(i);case i:l.zoom._startZoomSelect()}}),k.on(a,function(){switch(l.state){case h:l.pointerMove();break;case i:l.tooltip.group.hide(),l.zoom._resizeZoomSelect();break;case j:l._pan(),l.tooltip.group.hide()}l.lastPos=k.getPointerPosition(),l.interactionLayer.batchDraw()}),k.on(g,function(){switch(l.state){case i:l.zoom._endZoomSelect(),l._setState(h),l.tooltip.group.show();break;case j:l._setState(h),l.tooltip.group.show(),k.draw(),l.fire("draw")}}),k.on(c,function(a){a.targetNode||l.showInteractionLayer()}),k.on(b,function(a){a.targetNode||l.hideInteractionLayer()}),k.on(d,function(){l.showInteractionLayer()}),k.on(e,function(){l.hideInteractionLayer()}),this.bottomLayer.on("beforeDraw",function(){l._draw()}),this.on("stateChange",function(){switch(l.state){case h:break;case j:break;case i:}})}}}(),function(){MeteorCharts.Util={merge:function(){var a,b,c,d,e=arguments.length,f=Array.prototype.slice.call(arguments);if(this.containsObjects(f))for(c={},a=0;e>a;a++){d=arguments[a];for(b in d)c[b]=d[b]}else for(a=e-1;a>=0;a--)if(d=arguments[a],void 0!==d){c=d;break}return c},extend:function(a,b){for(var c in b.prototype)c in a.prototype||"init"===c||(a.prototype[c]=b.prototype[c])},isObject:function(a){return!!a&&a.constructor==Object},containsObjects:function(a){var b,c,d=a.length;for(b=0;d>b;b++)if(c=a[b],void 0!==c&&!this.isObject(c))return!1;return!0},get:function(a,b){var c,d=b.length;for(c=0;d>c&&(a=a[b[c]],void 0!==a);c++);return c===d?a:void 0}}}(),function(){var a=[1,2,3,5,10,15,30,50];MeteorCharts.Formatter=function(a,b,c){this.min=a,this.max=b,this.range=this.max-this.min,this.maxCount=c},MeteorCharts.Formatter.prototype={getIncrement:function(){var a,b,c=this.range,d=this._getIncrements(),e=d.length,f=this.maxCount;for(b=0;e>b;b++)if(a=d[b],a>=c/f)return a;return c},_getIncrements:function(){var b,c,d=[],e=this.base,f=a.length;for(b=0;7>b;b++)for(c=0;f>c;c++)d.push(a[c]*Math.pow(e,b));return d},getLongestValue:function(){return Math.max(Math.abs(this.max),Math.abs(this.min))}}}(),function(){MeteorCharts.View=function(a){this.chart=a},MeteorCharts.View.DEFAULT={backgroundColor:"black",width:900,height:450,padding:10,spacing:10,text:{fill:"#ccc",fontSize:16},title:{text:{fontSize:24}},legend:{layout:"top",text:{fontSize:20},spacing:20},xAxis:{min:"auto",max:"auto",maxNumberOfLabels:10,lines:{stroke:"#555",strokeWidth:2},formatter:"Date"},yAxis:{min:"auto",max:"auto",maxNumberOfLabels:8,lines:{stroke:"#555",strokeWidth:2},formatter:"Number"},series:[{stroke:"#afe225",strokeWidth:2,lineJoin:"round"},{stroke:"#76d0ff",strokeWidth:2,lineJoin:"round"},{stroke:"#fc009a",strokeWidth:2,lineJoin:"round"}],tooltip:{text:{fill:"black",fontSize:16,padding:4},tag:{fill:"#e8e8e8",pointerWidth:10,pointerHeight:10,lineJoin:"round",shadowColor:"black",shadowBlur:10,shadowOffset:5,shadowOpacity:.5}},zoom:{type:"box",selection:{fill:"white",opacity:.3}}},MeteorCharts.View.prototype={get:function(){var a=Array.prototype.slice.call(arguments),b=MeteorCharts.Util,c=b.get,d=this.chart.view,e=a.length,f=e-1,g=MeteorCharts.View.DEFAULT;return b.merge(c(g,[a[f]]),c(g,a),c(d,[a[f]]),c(d,a))},set:function(){var a,b,c=this.chart.view,d=arguments[0],e=arguments[1];switch(arguments.length){case 2:c[d]=e;break;case 3:a=arguments[2],void 0===c[d]&&(c[d]={}),c[d][e]=a;break;case 4:a=arguments[2],b=arguments[3],void 0===c[d]&&(c[d]={}),void 0===c[d][e]&&(c[d][e]={}),c[d][e][a]=b}},getSeriesStyle:function(a){var b=this.get("series"),c=b.length;return b[a%c]}}}(),function(){function a(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}MeteorCharts.Number=function(a,b,c){MeteorCharts.Formatter.call(this,a,b,c),this.base=10},MeteorCharts.Number.prototype={formatShort:function(b){var c=this.getLongestValue();return 1e3>c?a(b):1e6>c?a(Math.round(10*(b/1e3))/10)+"k":1e9>c?a(Math.round(10*(b/1e6))/10)+"M":a(Math.round(10*(b/1e9))/10)+"B"}},MeteorCharts.Util.extend(MeteorCharts.Number,MeteorCharts.Formatter)}(),function(){var a=60,b=3600,c=86400,d=2628e3,e=315e5;MeteorCharts.Date=function(a,b,c){MeteorCharts.Formatter.call(this,a,b,c),this.base=60},MeteorCharts.Date.prototype={formatShort:function(f){var g=this.range,h=new Date(1e3*f);return a>g?h.format("MM:sstt"):b>g?h.format("h:MMtt"):c>g?h.format("ddd htt"):d>g?h.format("mmm dd"):e>g?h.format("mmm yyyy"):h.format("yyyy")}},MeteorCharts.Util.extend(MeteorCharts.Date,MeteorCharts.Formatter)}(),function(){var a=60,b=3600,c=86400,d=2628e3;MeteorCharts.Seconds=function(a,b,c){MeteorCharts.Formatter.call(this,a,b,c),this.base=60},MeteorCharts.Seconds.prototype={formatShort:function(e){var f=0>e?"-":"",g=Math.abs(e),h=new Date(1e3*g),i="",j=this.getLongestValue();return i=a>j?h.format('UTC:ss"s"'):b>j?h.format('UTC:MM:ss"m"'):c>j?h.format('UTC:HH:MM"h"'):d>j?h.format('UTC:d"d" H"h"'):h.format('UTC:m"m" d"d"'),f+i}},MeteorCharts.Util.extend(MeteorCharts.Seconds,MeteorCharts.Formatter)}(),function(){MeteorCharts.Legend=function(a){this.chart=a,this.group=new Kinetic.Group,this.addLabels()},MeteorCharts.Legend.prototype={addLabels:function(){var a,b,c,d,e=this.chart,f=this.group,g=e.model,h=e._view,i=h.get("padding"),j=g.series,k=j.length,l=0;for(a=0;k>a;a++)b=j[a],d=new Kinetic.Line(MeteorCharts.Util.merge({x:l,points:[0,0,10,0],stroke:e._view.getSeriesStyle(a).stroke,strokeWidth:3,listening:!1,lineCap:"round"})),l+=16,c=new Kinetic.Text(MeteorCharts.Util.merge(h.get("legend","text"),{text:b.title,x:l,listening:!1})),l+=c.getWidth(),k-1>a&&(l+=h.get("legend","spacing")),d.setY(c.getHeight()/2),f.add(d).add(c);this.width=l,f.setPosition(h.get("width")-l-i,i),e.bottomLayer.add(f)},getWidth:function(){return this.width||0},hide:function(){this.group.hide()}}}(),function(){MeteorCharts.Title=function(a){var a=this.chart=a,b=this.model=a.model,c=a._view,d=(b.str="",c.get("padding")),e=this.text=new Kinetic.Text(MeteorCharts.Util.merge(c.get("title","text"),{text:b.title,listening:!1,x:d,y:d}));a.bottomLayer.add(e)},MeteorCharts.Title.prototype={getWidth:function(){return this.text.getWidth()||0},hide:function(){this.text.hide()}}}(),function(){MeteorCharts.XAxis=function(a){this.chart=a,this.maxNumberOfLabels=a._view.get("xAxis","maxNumberOfLabels"),this.formatter=new(MeteorCharts[a._view.get("xAxis","formatter")])(a.minX,a.maxX,this.maxNumberOfLabels),this.addXLabels()},MeteorCharts.XAxis.prototype={addXLabels:function(){var a,b,c=this.chart,d=this.formatter,e=c.maxX,f=c.minX,g=c.scaleX,h=d.getIncrement(),i=Math.ceil(f/h)*h;for(a=i;e>a;a+=h)b=(a-f)*g+c.dataX,this.addXLabel(d.formatShort(a),b)},addXLabel:function(a,b){var c,d=this.chart,e=d._view,f=e.get("xAxis","lines"),g=d.dataY,h=d.dataHeight,i=d.bottomLayer,j=e.get("height")-e.get("text","fontSize")-e.get("padding"),k=new Kinetic.Text(MeteorCharts.Util.merge(e.get("text"),{text:a,x:b,y:j,listening:!1}));k.setOffsetX(k.getWidth()/2),"none"!==f&&(c=new Kinetic.Line(MeteorCharts.Util.merge(f,{points:[b,g,b,g+h],listening:!1})),i.add(c)),d.topLayer.add(k)}}}(),function(){MeteorCharts.YAxis=function(a){this.chart=a,this.maxNumberOfLabels=a._view.get("yAxis","maxNumberOfLabels"),this.formatter=new(MeteorCharts[a._view.get("yAxis","formatter")])(a.minY,a.maxY,this.maxNumberOfLabels),this.lineGroup=new Kinetic.Group,a.bottomLayer.add(this.lineGroup),this.addYLabels()},MeteorCharts.YAxis.prototype={addYLabels:function(){for(var a,b=this.chart,c=this.formatter,d=b.minY,e=b.maxY,f=c.getIncrement(),g=b.dataHeight,h=b.scaleY,i=0,j=0;e>=i;)i>=d&&(a=this.addYLabel(c.formatShort(i),Math.round(g+(d-i)*h)),j=Math.max(a,j)),i+=f;for(i=-1*f;i>=d;)e>=i&&(a=this.addYLabel(c.formatShort(i),Math.round(g+(d-i)*h)),j=Math.max(a,j)),i-=f;b.dataX=j+10+b._view.get("padding"),this.lineGroup.setX(b.dataX)},addYLabel:function(a,b){var c,d=this.chart,e=d._view,f=e.get("padding"),g=(e.get("width"),d.dataHeight,d.dataY),h=(d.bottomLayer,d.topLayer,e.get("yAxis","lines")),i=new Kinetic.Text(MeteorCharts.Util.merge(e.get("text"),{text:a,x:f,y:b-8+g,listening:!1})),j=this.lineGroup;return"none"!==h&&(c=new Kinetic.Line(MeteorCharts.Util.merge(h,{y:b+g,listening:!1})),j.add(c)),d.topLayer.add(i),i.getWidth()}}}(),function(){MeteorCharts.Tooltip=function(a){var b=this.group=new Kinetic.Group,c=this.node=new Kinetic.Circle,d=this.text=new Kinetic.Text({}),e=this.tag=new Kinetic.Tag,f=this.label=new Kinetic.Label({y:-12});this.chart=a,f.add(e).add(d),b.add(c).add(f),a.interactionLayer.add(b)},MeteorCharts.Tooltip.prototype={style:function(){var a=this.chart._view;this.node.setAttrs({radius:5,stroke:a.get("backgroundColor"),strokeWidth:3,listening:!1}),this.text.setAttrs(MeteorCharts.Util.merge(a.get("tooltip","text"),{text:"",listening:!1})),this.tag.setAttrs(MeteorCharts.Util.merge(a.get("tooltip","tag"),{pointerDirection:"down",listening:!1}))}}}(),function(){var a="dblclick",b=20;MeteorCharts.Zoom=function(a){this.chart=a,this.selecting=!1,this.startX=0,this.startY=0,this.rect=new Kinetic.Rect({listening:!1}),a.interactionLayer.add(this.rect),this._bind()},MeteorCharts.Zoom.prototype={style:function(){this.rect.setAttrs(MeteorCharts.Util.merge(this.chart._view.get("zoom","selection"),{width:0,height:0}))},_bind:function(){var b=this.chart,c=b.stage;c.on(a,function(){b.view.xAxis.min="auto",b.view.xAxis.max="auto",b.view.yAxis.min="auto",b.view.yAxis.max="auto",b.draw()})},_startZoomSelect:function(){var a=this.chart,b=a.stage.getPointerPosition(),c=(a.view,a._view.get("zoom","type"));this.selecting=!0,this.startX=b.x,this.startY="box"===c?b.y:a.dataY,this.rect.setPosition(this.startX,this.startY)},_resizeZoomSelect:function(){var a,b,c,d=this.rect,e=this.chart;this.selecting&&(a=e.stage.getPointerPosition(),b=e.view,c=e._view.get("zoom","type"),this.rect.setWidth(a.x-this.startX),this.rect.setHeight("box"===c?a.y-this.startY:e.dataHeight),d.isVisible()||d.setVisible(!0))},_endZoomSelect:function(){this.selecting=!1,this._updateMinMax(),this.startX=0,this.startY=0,this.rect.setSize(0),this.rect.setVisible(!1)},_updateMinMax:function(){var a=this.chart,c=(a.view,a._view),d=a._view.get("zoom","type");pos=a.stage.getPointerPosition(),startX=this.startX,startY=this.startY,rect=this.rect,chartMinX=Math.min(startX,pos.x),chartMinY="box"===d?Math.max(startY,pos.y):a.dataY+a.dataHeight,chartMaxX=Math.max(startX,pos.x),chartMaxY="box"===d?Math.min(startY,pos.y):a.dataY,min=a.chartToData(chartMinX,chartMinY),max=a.chartToData(chartMaxX,chartMaxY),Math.abs(chartMaxX-chartMinX)>b&&Math.abs(chartMaxY-chartMinY)>b&&(c.set("xAxis","min",min.x),c.set("yAxis","min",min.y),c.set("xAxis","max",max.x),c.set("yAxis","max",max.y),a.draw())}}}(),function(){var a=15;MeteorCharts.Line=function(a){MeteorCharts.Chart.call(this,a),this.__init(a)},MeteorCharts.Line.prototype={__init:function(){this.zoom=new MeteorCharts.Zoom(this),this.tooltip=new MeteorCharts.Tooltip(this),this.draw()},_draw:function(){var a=this,b=this.getAutoMinMax(),c=this.view,d=this._view,e=d.get("padding"),f=(c.xAxis,c.yAxis,d.get("xAxis","min")),g=d.get("yAxis","min"),h=d.get("xAxis","max"),i=d.get("yAxis","max"),j=this.minX="auto"===f?b.minX:f,k=this.minY="auto"===g?b.minY:g,l=this.maxX="auto"===h?b.maxX:h,m=this.maxY="auto"===i?b.maxY:i,n=this.stage,o=n.getContainer();this.zoom.style(),this.tooltip.style(),this.bottomLayer.destroyChildren(),this.dataLayer.destroyChildren(),this.topLayer.destroyChildren(),o.style.backgroundColor=d.get("backgroundColor"),this.dataY=d.get("title","text","fontSize")+d.get("spacing")+e,this.dataHeight=d.get("height")-this.dataY-d.get("text","fontSize")-d.get("spacing")-e,this.scaleY=this.dataHeight/(m-k),this.yAxis=new MeteorCharts.YAxis(this),this.dataWidth=d.get("width")-this.dataX-e,this.yAxis.lineGroup.getChildren().each(function(b){b.setPoints([0,0,a.dataWidth,0])}),this.scaleX=this.dataWidth/(l-j),this.xAxis=new MeteorCharts.XAxis(this),this.legend=new MeteorCharts.Legend(this),this.title=new MeteorCharts.Title(this),this.title.getWidth()+this.legend.getWidth()+2*e+d.get("spacing")>d.get("width")&&this.legend.hide(),this.addLines(),this.pointerMove(),this.clipTween&&this.clipTween.destroy(),this.enableSeriesTween?(this.dataLayer.setClip([this.dataX,this.dataY,1,this.dataHeight]),this.clipTween=new Kinetic.Tween({clipWidth:a.dataWidth,duration:1,easing:Kinetic.Easings.Linear,node:a.dataLayer}),this.clipTween.play()):this.dataLayer.setClip([this.dataX,this.dataY,this.dataWidth,this.dataHeight])},getAutoMinMax:function(){var a,b,c,d,e,f,g=this.model,h=(this.view,g.series),i=h.length,j=h[0].points[0],k=j.x,l=j.y,m=k,n=l,o=k,p=l;for(a=0;i>a;a++)for(line=h[a],points=line.points,c=points.length,b=0;c>b;b++)d=points[b],e=d.x,f=d.y,m=Math.min(m,e),n=Math.min(n,f),o=Math.max(o,e),p=Math.max(p,f);return{minX:m,minY:n,maxX:o,maxY:p}},pointerMove:function(){var a=this.stage.getPointerPosition();if(!a)return!1;var b=(this.view,this._view),c=(b.get("width"),this.model),d=c.series,e=this.minX,f=this.maxX,g=this.minY,h=this.maxY,i=f-e,j=h-g,k=this.dataX,l=this.dataY;this.dataHeight,this.scaleX,this.scaleY,b.get("height");for(var m=(a.x-k)/this.dataWidth,n=(a.y-l)/this.dataHeight,o=i*m+e,p=h-j*n,q=[],r=0;r<d.length;r++){for(var s=d[r],t=s.points,u={x:t[0].x,y:t[0].y,color:b.getSeriesStyle(r).stroke},v=0;v<t.length;v++){var w=t[v];Math.max(o,w.x)-Math.min(o,w.x)<Math.max(o,u.x)-Math.min(o,u.x)&&(u.x=w.x,u.y=w.y)}q.push(u)}for(var x=q[0],r=1;r<q.length;r++){var w=q[r];Math.max(p,w.y)-Math.min(p,w.y)<Math.max(p,x.y)-Math.min(p,x.y)&&(x=w)}var y=this.dataToChart(x.x,x.y),z=this.xAxis.formatter.formatShort(x.x)+", "+this.yAxis.formatter.formatShort(x.y);this.tooltip.group.setPosition(y),this.tooltip.node.setFill(x.color),this.tooltip.text.setText(z)},dataToChartX:function(a){return(a-this.minX)*this.scaleX+this.dataX},dataToChartY:function(a){return this.dataHeight-(a-this.minY)*this.scaleY+this.dataY},dataToChart:function(a,b){return{x:this.dataToChartX(a),y:this.dataToChartY(b)}},dataToChartPoints:function(a){var b,c,d=[],e=(this.scaleX,this.scaleY,a.length);for(b=0;e>b;b++)c=a[b],d.push(this.dataToChart(c.x,c.y));return d},chartToData:function(a,b){return{x:(a-this.dataX)/this.scaleX+this.minX,y:this.minY-(b-this.dataHeight-this.dataY)/this.scaleY}},addLine:function(a,b,c){var d=new Kinetic.Line(MeteorCharts.Util.merge(b,{points:a,listening:!1}));this.dataLayer.add(d),c&&this.addNodes(a,b)},addNodes:function(a,b){var c,d,e=this._view,f=a.length,g=this.dataLayer;for(c=0;f>c;c++)d=a[c],g.add(new Kinetic.Circle({x:d.x,y:d.y,radius:5,stroke:e.get("backgroundColor"),strokeWidth:3,fill:b.stroke,listening:!1}))},getStartEnd:function(a){var b,c,d,e=this.minX,f=this.maxX,g=a.length;for(d=0;g>d;d++)if(point=a[d],void 0===b&&point.x>=e&&(b=0===d?0:d-1),void 0===c&&point.x>=f){c=d;break}return void 0===c&&(c=g-1),{start:b,end:c}},addLines:function(){var b,c,d,e,f,g,h,i,j,k=this.model,l=k.series,m=l.length;for(this.minX,this.maxX,c=0;m>c;c++)d=l[c],e=d.points,b=this._view.getSeriesStyle(c),newPoints=[],g=this.getStartEnd(e),h=g.start,i=g.end,f=!1,void 0!==h&&void 0!==i&&(j=this.dataToChartX(e[i].x)-this.dataToChartX(e[h].x),f=j/(i-h)>a),newPoints=e.slice(h,i+1),newPoints.length>1&&this.addLine(this.dataToChartPoints(newPoints),b,f)},_pan:function(){var a,b,c=this.stage.getPointerPosition(),d=(this.view,this._view);this.lastPos&&(a=(c.x-this.lastPos.x)/this.scaleX,b=(c.y-this.lastPos.y)/this.scaleY,d.set("xAxis","min",this.minX-a),d.set("xAxis","max",this.maxX-a),d.set("yAxis","min",this.minY+b),d.set("yAxis","max",this.maxY+b),this.batchDraw())}},MeteorCharts.Util.extend(MeteorCharts.Line,MeteorCharts.Chart)}();